<!-- src/app/pages/profile/profile.page.html -->
<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>My Profile</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="toggleEditMode()">
        <ion-icon [name]="isEditing ? 'close-outline' : 'create-outline'"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="profile-header">
    <div class="profile-image-container" (click)="isEditing && changeProfileImage()">
      <img [src]="profileImage" alt="Profile" class="profile-image">
      <div class="image-overlay" *ngIf="isEditing">
        <ion-icon name="camera"></ion-icon>
      </div>
    </div>
    <h2 class="profile-name" *ngIf="!isEditing">
      {{ profileForm.get('firstName')?.value }} {{ profileForm.get('lastName')?.value }}
    </h2>
    <p class="profile-sport" *ngIf="!isEditing && profileForm.get('sport')?.value">
      {{ profileForm.get('sport')?.value }} {{ profileForm.get('team')?.value ? 'â€¢ ' + profileForm.get('team')?.value : '' }}
    </p>
  </div>

  <form [formGroup]="profileForm">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Personal Information</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">First Name</ion-label>
          <ion-input formControlName="firstName" type="text"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Last Name</ion-label>
          <ion-input formControlName="lastName" type="text"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Date of Birth</ion-label>
          <ion-datetime-button datetime="birthDate"></ion-datetime-button>
          <ion-modal [keepContentsMounted]="true">
            <ng-template>
              <ion-datetime
                id="birthDate"
                presentation="date"
                formControlName="birthDate"
              ></ion-datetime>
            </ng-template>
          </ion-modal>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Gender</ion-label>
          <ion-select formControlName="gender">
            <ion-select-option value="male">Male</ion-select-option>
            <ion-select-option value="female">Female</ion-select-option>
            <ion-select-option value="other">Other</ion-select-option>
            <ion-select-option value="prefer-not-to-say">Prefer not to say</ion-select-option>
          </ion-select>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Athletic Information</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">Sport</ion-label>
          <ion-select formControlName="sport">
            <ion-select-option *ngFor="let sport of sportsList" [value]="sport">{{ sport }}</ion-select-option>
          </ion-select>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Team/Club</ion-label>
          <ion-input formControlName="team" type="text"></ion-input>
        </ion-item>
        <ion-row>
          <ion-col size="6">
            <ion-item>
              <ion-label position="floating">Height (cm)</ion-label>
              <ion-input formControlName="height" type="number"></ion-input>
            </ion-item>
          </ion-col>
          <ion-col size="6">
            <ion-item>
              <ion-label position="floating">Weight (kg)</ion-label>
              <ion-input formControlName="weight" type="number"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
        <ion-item>
          <ion-label position="floating">Goals</ion-label>
          <ion-textarea formControlName="goals" rows="3"></ion-textarea>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Contact Information</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">Email</ion-label>
          <ion-input formControlName="email" type="email"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Phone</ion-label>
          <ion-input formControlName="phone" type="tel"></ion-input>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Emergency & Medical</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">Emergency Contact</ion-label>
          <ion-input formControlName="emergencyContact" type="text"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Emergency Phone</ion-label>
          <ion-input formControlName="emergencyPhone" type="tel"></ion-input>
        </ion-item>
        <ion-item>
          <ion-label position="floating">Medical Notes</ion-label>
          <ion-textarea formControlName="medicalNotes" rows="3" placeholder="Allergies, conditions, medications, etc."></ion-textarea>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <div class="action-buttons" *ngIf="isEditing">
      <ion-button expand="block" (click)="saveProfile()" color="success">
        <ion-icon name="save-outline" slot="start"></ion-icon>
        Save Profile
      </ion-button>
    </div>
  </form>

  <ion-button expand="block" fill="clear" color="danger" (click)="logout()" class="logout-button">
    <ion-icon name="log-out-outline" slot="start"></ion-icon>
    Log Out
  </ion-button>
</ion-content>
